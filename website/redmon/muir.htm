<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 2.0">
<title>Ghostscript, RedMon and Windows NT</title>
<link rel="stylesheet" type="text/css" href="../gsweb.css" title="Ghostscript Website Style">
</head>

<body>

<h1>Ghostscript, Redmon and Windows NT</h1>

<hr>

<h2><a name="top">Table of Contents</a></h2>

<ol>
    <li><a href="#how">Why does the Print Setup dialog appear
        when I print to the Postscript printer?</a></li>
    <li><a href="#nocancel">How do I disable the Cancel dialog box?</a></li>
</ol>

<hr>

<h3><a name="how">Why does the Print Setup dialog appear when I
print to the Postscript printer?</a></h3>

<p>This dialog does not appear if you print from the
command-line:</p>

<p><code>%GS_LIB%\gswin32c -dNOPAUSE -I%GS_LIB%;%GS_LIB%\fonts
-sDEVICE=mswinpr2 -sOutputFile=&quot;\\spool\label&quot; - </code></p>

<p>The dialog does appear if you put the same code into the RPT1
Port Configuration dialog box. The reason is the code in the
mswinpr2 print driver tries to find the printer specified in the
-sOutputFile option (without the \\spool\). However, when the
spooler runs under the SYSTEM account which has different
registry settings, the code in mswinpr2 uses the Win32
GetProfileString to get the entire [Devices] in win.ini. Under
Windows NT 4.0, this section is mapped to the user profile.</p>

<p><code>REGEDIT4 <br>
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows
NT\CurrentVersion\IniFileMapping\win.ini]<br>
&quot;Devices&quot;=&quot;USR:Software\\Microsoft\\Windows
NT\\CurrentVersion\\Devices&quot;<br>
&quot;PrinterPorts&quot;=&quot;USR:Software\\Microsoft\\Windows
NT\\CurrentVersion\\PrinterPorts&quot;</code> </p>

<p>On my machine, the administrator account has this in the
registry.</p>

<p><code>REGEDIT4 <br>
[HKEY_CURRENT_USER\Software\Microsoft\Windows
NT\CurrentVersion\Devices]<br>
&quot;Brother PTouchPC PS&quot;=&quot;winspool,RPT1:&quot;<br>
&quot;label&quot;=&quot;winspool,FILE:&quot;</code> </p>

<p>When gswin32c runs under the system account, the above devices
are missing and the mswinpr2 driver thinks the devices do not
exist. To allow it to find the driver, add the following registry
setting to the default user registry.</p>

<p><code>REGEDIT4<br>
[HKEY_USERS\.DEFAULT\Software\Microsoft\Windows
NT\CurrentVersion\Devices]<br>
&quot;label&quot;=&quot;winspool,FILE:&quot;</code> </p>

<P>
This information was contributed by 
<A HREF="mailto:muirp@fibersoft.com">muirp@fibersoft.com</A>.
</P>

<p><a href="#top">Back to Top</a> </p>

<hr>

<h3><a name="nocancel"></a>How do I disable the Cancel dialog box?</h3>
<P>
When using the mswinpr2 device with RedMon, a "Cancel" dialog box 
is displayed showing progress.
To disable the "Cancel" dialog box, add -dNoCancel to the Ghostscript
command line..
</P>

<p><a href="#top">Back to Top</a> </p>

<hr>

<p>&nbsp;</p>
</body>
</html>

