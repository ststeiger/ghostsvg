%  Copyright (C) 2000 Artifex Software Inc.   All rights reserved.
% 
% This file is part of AFPL Ghostscript.
% 
% AFPL Ghostscript is distributed with NO WARRANTY OF ANY KIND.  No author or
% distributor accepts any responsibility for the consequences of using it, or
% for whether it serves any particular purpose or works at all, unless he or
% she says so in writing.  Refer to the Aladdin Free Public License (the
% "License") for full details.
% 
% Every copy of AFPL Ghostscript must include a copy of the License, normally
% in a plain ASCII text file named PUBLIC.  The License grants you the right
% to copy, modify and redistribute AFPL Ghostscript, but only under certain
% conditions described in the License.  Among other things, the License
% requires that the copyright notice and this notice be preserved on all
% copies.

% $Id$
%  Postscript interface routines to DSC parser


/send_orientation {			% <orientation> send_orienation -
  << /Orientation 2 index >> setpagedevice pop
} bind def

% This dictionary contains local handlers for DSC comments.  See header in zdscpars.c
% <dsc_dict> handler <dsc_dict>
/DSCparseprocs mark
   /Orientation { dup /Orientation get send_orientation } bind
   /PageOrientation { dup /PageOrientation .knownget { send_orientation }
		      { dup /Orientation .knownget { send_orientation } if }
		      ifelse } bind
   /Page { dup /Orientation .knownget { send_orientation } if } bind
   /NOP { } bind
.dicttomark readonly def

% This procedure is called whenever a DSC comment is found by the interpreter
/parse_dsc {				% <file> <DSC string> parse_dsc -
  dsc_dict exch				% <file> <dict> <string>
  .parse_dsc_comments			% <file> <dict> <name>
  //DSCparseprocs exch .knownget {
    exec				% execute any local handler
  } if
  pop pop				% remove file and dict
} bind def


% - dsc_init -
/dsc_init {				% Initialize DSC parser
  /dsc_dict 50 dict def			% Size must be large enough for all DSC values
  dsc_dict .initialize_dsc_parser
  << /ProcessDSCComment /parse_dsc load >> setuserparams
} bind def


% - enable_dsc -
/enable_dsc {				% enable DSC parser
  dsc_init
} bind def

% Disable DSC parser - replace DSC parser with do nothing parser
% - disable_dsc -
/disable_dsc {				% disable the DSC parser
  << /ProcessDSCComment {pop pop} >> setuserparams
} bind def
